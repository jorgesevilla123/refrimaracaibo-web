




<app-cart-overview>





<div *ngFor="let section of sections">



    <mat-card style="margin-bottom: 20px;">



        <div class="filter-controls">


            <mat-form-field appearance="outline" class="filter-form">
                <mat-label>Filtrar</mat-label>
                <mat-select [formControl]="filters" multiple>
                    <!-- <mat-select-trigger>
                        {{filters.value?.[0].label_value || ''}}
                        <span *ngIf="(filters.value?.length || 0) > 1">
                            (+{{(filters.value?.length || 0) -1}} {{filters.value?.length === 2 ? 'otro': 'otros'}})
                        </span>
                    </mat-select-trigger> -->
                    <mat-option *ngFor="let category of categories" [value]="category" (onSelectionChange)="optionHandler($event)">
                        <span><b>{{category.label_name}}</b></span> | <span>{{category.label_value}}</span>
                    </mat-option>
                </mat-select>
                <mat-icon matSuffix>filter_alt</mat-icon>

            </mat-form-field>





            <mat-form-field appearance="outline" class="filter-form">
                <mat-label>Ordernar por</mat-label>
                <mat-select [formControl]="sort" multiple  (valueChange)="filterByPrice($event)">
                    <mat-select-trigger>
                        {{sort.value?.[0] || ''}}
                        <span *ngIf="(sort.value?.length || 0) > 1">
                            (+{{(sort.value?.length || 0) -1}} {{sort.value?.length === 2 ? 'otro': 'otros'}})
                        </span>
                    </mat-select-trigger>
                    <mat-option *ngFor="let sort of sortList" [value]="sort">{{sort}}</mat-option>
                </mat-select>
                <mat-icon matSuffix>sort</mat-icon>



            </mat-form-field>



            <app-main-search-bar></app-main-search-bar>


<!-- 
            
            <mat-form-field appearance="outline" class="filter-form">
                <mat-label>Categorias</mat-label>
                <mat-select [formControl]="categoryFilterForm" multiple (valueChange)="filterCategory($event)">
                    <mat-select-trigger>
                        {{categoryFilterForm.value?.[0] || ''}}
                        <span *ngIf="(categoryFilterForm.value?.length || 0) > 1">
                            (+{{(categoryFilterForm.value?.length || 0) -1}} {{categoryFilterForm.value?.length === 2 ? 'otro': 'otros'}})
                        </span>
                    </mat-select-trigger>
                    <mat-option *ngFor="let sort of categoryFilter" [value]="sort">{{sort}}</mat-option>
                </mat-select>
                <mat-icon matSuffix>category</mat-icon>



            </mat-form-field>

 -->




        </div>

        
        <mat-chip-list #chipList aria-label="Fruit selection">
            <mat-chip style="margin-bottom: 20px; background-color: dodgerblue; color: white;" *ngFor="let label of categoryChips" (removed)="remove(label)">
              {{label.name}}
              <button matChipRemove>
                <mat-icon>cancel</mat-icon>
              </button>
            </mat-chip>
         
          </mat-chip-list>




          

        <mat-divider></mat-divider>


        
        <h3 style="text-align: center; font-weight: 200; font-size: 30px; margin-top: 20px;">{{pageName}}</h3>




        <div *ngIf="isFiltering && matchExist; else noMatch">



         
            <mat-grid-list rowHeight="350px" cols="3">
   

        
    
                <mat-grid-tile *ngFor="let product of sectionsToRender">
        
                    <!-- this is the product card -->
                    <div style="width: 250px" class="products-ui" >
                      
            
                        <div class="image">
                            <img class="products-img" 
                                [src]="product.imagePath" alt="">
        
                        </div>
        
                        <div>
                            
                        <h4 class="product-title" (click)="getDescription(product)">{{product.title}}</h4>
                        <h2 style="color: rgb(1, 157, 1);">{{product.precio | currency: 'USD'}}</h2>
        
                        
                        <div *ngIf="checkCart(product); then isInCart else notInCart"></div>
        
        
        
                        <ng-template #isInCart>
                            <button class="cart-button" mat-stroked-button style="background-color: red" (click)="removeFromCart(product)">
                                Eliminar del carrito <mat-icon>delete</mat-icon>
                                </button>
                        </ng-template>
        
        
        
        
                        <ng-template #notInCart>
                            <button class="cart-button"  style="background-color: dodgerblue;" mat-stroked-button (click)="addToCart(product)">
                                Agregar a carrito <mat-icon>add_shopping_cart</mat-icon>
                            </button>
                        </ng-template>
                        
        
                        </div>
        
                      
                     
                    </div>
                </mat-grid-tile>
        
            </mat-grid-list>
        
                

        </div>


        <ng-template #noMatch>
            <h2 style="margin-top: 10px;">No hay productos que coincidan</h2>

        </ng-template>

  
        
  
<div *ngIf="!completed; else paginator">
    <h2>load</h2>
    
</div>

<ng-template #paginator>
    
    
    <app-pagination [pager]="pager" [pageName]="pageName"  [currentPage]="currentPage"></app-pagination>



</ng-template>


    </mat-card>


</div>



  </app-cart-overview>
